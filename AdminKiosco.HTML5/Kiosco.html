<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
	<link rel="stylesheet" type="text/css" href="Styles/style.css?v=20140729233000" media="screen" />
    <link rel="stylesheet" type="text/css" href="Styles/tablestyle.css?v=20140729233000" media="screen" />
	<script src="Scripts/knockout-3.1.0.js" type="text/javascript" ></script>
	<script src="Scripts/jquery-1.11.1.min.js" type="text/javascript" ></script>
    <script src="Scripts/datajs-1.1.2.min.js" type="text/javascript"></script>
    <script src="Scripts/service.js" type="text/javascript"></script>
</head>
<body>
	<script type="text/javascript">
		$(function(){
		    $("#footer").load("footer.html");
		    $("#header").load("header.html");
	  
		});

		// This is what our view model looks like.
		var KioscoViewModelFn = function (kioscos) {
		    var that = this;

		    self.kiosco = ko.observableArray(kioscos);

		    // A flag indicating whether we are communicating with the server.
		    this.communicating = ko.observable(false);

		    // Adds the newIdea placeholder to the list and saves to the server.
		    self.headers = [
                { title:'Accion'},
                { title: 'Id', sortKey: 'Id' },
                { title: 'Nombre', sortKey: 'Nombre' },
		    ];

		    self.sort = function (header, event) {
		        alert('joda');
		        var sortKey = header.sortKey;
		        switch (sortKey) {
		            case 'Nombre':
		                self.kiosco.sort(function (a, b) {
		                    return a.Nombre < b.Nombre ? -1 : a.Nombre > b.Nombre ? 1 : a.Nombre == b.Nombre ? 0 : 0;
		                });
		                break;
		            case 'Id':
		                self.kiosco.sort(function (a, b) {
		                    return a.Id < b.Id ? -1 : a.Id > b.Id ? 1 : a.Id == b.Id ? 0 : 0;
		                });
		                break;
		        }
		    };


		};


		$(document).ready(function () {

		    $("#loading-div-background").css({ opacity: 0.8 });

		    ShowProgressAnimation(true);

		    makeRequest({ requestUri: serviceUri + "Kiosco" }, function (data) {

		        //ko.applyBindings({
		        //    kioscos: data.results
		        //});

		        ko.applyBindings(new KioscoViewModelFn(data.results));

		        ShowProgressAnimation(false);

		    });
		
		    
		    
		});

		function ShowProgressAnimation(mustShow) {

		    if (mustShow) {

		        $("#loading-div-background").show();
		    } else {
		        $("#loading-div-background").hide();
		    }

		}
	
    </script>
	<div id="header"></div>
    <div id="loading-div-background">
        <div id="loading-div" class="ui-corner-all">
            <img alt="Loading.." src="Styles/Images/loading.gif" style="height: 30px; margin: 30px;">
            <br />
            <h2 style="color: black; font-weight: normal;">


                Por favor espere...
            </h2>
        </div>
    </div>
	<div id="mainContainer">
        <div id="mainContent">
            <table class="formatHTML5">
                <thead>
                    <tr data-bind="foreach: headers">
                        <td data-bind="click: $parent.sort, text: title"></td>
                    </tr>
                </thead>
                <tbody data-bind="foreach: kiosco">
                    <tr>
                        <td>
                            <a href="services.html">Crear</a>
                            <a href="services.html">Borrar</a>
                        </td>
                        <td data-bind="text: Id"></td>
                        <td data-bind="text: Nombre"></td>
                    </tr>
            </table>

        </div>
	</div>
	<div id="footer"></div>
</body>
</html>